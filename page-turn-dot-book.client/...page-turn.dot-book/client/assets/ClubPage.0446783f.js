import{_ as G,w as H,G as K,j as T,e as m,P as i,l as u,m as _,A as r,H as U,C as W,q as Q,c,f as o,s as v,t as g,F as x,u as p,y as h,x as L,I as X,z as Y,J as q,D as y,o as n,K as Z,B as $,p as ee,i as oe,E as te}from"./index.d2641df4.js";import{c as f}from"./ClubMembersService.ca39159b.js";const se={setup(){const l=Y(),d=$();async function I(){try{const e=l.params.clubId;await _.getClubBooks(e)}catch(e){i.error(e,"getting club books")}}async function t(){try{const e=l.params.clubId;u.log(e),await _.getClubById(e)}catch{i.error("getting club by id"),d.push("/")}}async function w(){try{const e=l.params.clubId;await f.getMembersByClubId(e)}catch(e){i.error(e.message)}}async function B(){try{const e=l.params.clubId;await te.getCommentsByClubId(e)}catch(e){u.error(e),i.error(e.message)}}function C(){try{q.emit("joined:room",{roomName:l.params.clubId})}catch(e){console.error(e),i.error("[ERROR]",e.message)}}function k(){try{q.emit("left:room",{roomName:r.clubId})}catch(e){console.error(e),i.error("[ERROR]",e.message)}}return H(()=>{l.params.clubId&&(C(),t(),w(),I(),B())}),K(()=>{window.scrollTo(0,0)}),T(()=>{k()}),{route:l,club:m(()=>r.activeClub),members:m(()=>r.members),foundMember:m(()=>r.members.find(e=>e.accountId==r.account.id)),myMembership:m(()=>r.members.find(e=>e.club.id==r.activeClub.id)),account:m(()=>r.account),clubBooksId:m(()=>r.activeClubBooks),activeClubBook:m(()=>r.activeClubBook),comments:m(()=>r.comments),expanded:m(()=>r.expanded),clubBooks:m(()=>r.activeClubBooks.sort((e,a)=>a.voteId.length-e.voteId.length)),async createMember(){try{await f.createMember({clubId:l.params.clubId})}catch(e){i.error("creating member"),u.error(e)}},async clubBookVoting(e){try{let a=this.account;a.voteId=this.account.id,u.log(a,"getting the members Id"),await f.clubBookVoting(e,a)}catch(a){i.error("add and unadd vote to Book"),u.error(a)}},async removeMember(e){try{await i.confirm()&&(await f.removeMember(e),u.log(e))}catch(a){i.error("removing member"),u.error(a)}},async setBookActive(e){try{const a=l.params.clubId;await _.setBookActive(e,a)}catch(a){i.error(a,"[setting book to active]")}},async removeClubBook(e){try{await i.confirm("Are you sure you want to remove this book from the club?","Some members might not like that...")&&await _.removeClubBook(e)}catch(a){i.error(a,"[removing club book]")}},expand(){u.log(r.expanded),r.expanded?r.expanded=!1:r.expanded=!0,u.log(r.expanded)},async archiveClub(){try{const e=l.params.clubId;await i.confirm("Are you sure you want to archive this club?","Make sure to let all your members know, some of them might be sad...")&&await _.archiveClub(e)}catch(e){i.error(e,"[archive club]")}}}},components:{ClubCard:U,CommentComponent:W,CreateCommentForm:Q}},b=l=>(ee("data-v-9925bb29"),l=l(),oe(),l),ce={class:"container-fluid"},ne={class:"row"},re={class:"col-12"},ae={class:"card text-start mt-2"},le=["src","alt"],ie={key:0,class:"text-end icon-container"},de={class:"card-body"},me={class:"card-title"},be={class:"card-text"},ue={class:"row justify-content-end"},_e={key:0,class:"col-6 text-end m-2"},ve=["disabled"],he=["disabled"],ke={class:"col-12 mt-3 bg-danger p-2"},ge=b(()=>o("h4",null,"Club Members",-1)),ye={class:"d-flex"},fe=["src","alt"],Ce={class:"container-fluid my-3"},xe={class:"row"},pe={class:"col-12 text-center bg-primary"},Ie=b(()=>o("h1",{class:"my-3"},"Currently Reading",-1)),we={key:0},Be=b(()=>o("img",{class:"mb-3 bookCover",src:"https://jackchovet.files.wordpress.com/2022/05/placeholder-cover-to-be-revealed.png?w=335",alt:""},null,-1)),Me=b(()=>o("p",{class:"mb-3 px-2 text-start"},"We're eagerly awaiting the club's next book selection. Please reach out to your club owner for more information on the upcoming book.",-1)),Ae=[Be,Me],Re={key:1},Se={class:"my-3"},Ve=b(()=>o("h3",{class:"text-center py-3"}," Club Comments! ",-1)),je={key:0},Pe={class:"row"},Ne={key:1},Ee=b(()=>o("div",{class:"bg-dark text-light p-3 rounded box-shadow indent"},[o("p",null,"no comments... yet?")],-1)),Fe=[Ee],ze={key:2,class:"d-flex flex-column align-items-center"},Oe={class:"container-fluid bg-warning"},De={class:"row"},Je=b(()=>o("div",{class:"col-12 text-center"},[o("h1",null,"Vote On Next Book")],-1)),Le={class:"d-flex scroll-x voting-area"},qe={class:"d-flex justify-content-between align-items-baseline px-3 pt-2"},Ge=["onClick"],He={class:"fw-bold"},Ke={key:0},Te=b(()=>o("div",{type:"button",class:"","data-bs-toggle":"dropdown","aria-expanded":"false"},[o("i",{class:"selectable text-dark mdi mdi-dots-horizontal fs-3",title:"remove/set active book"})],-1)),Ue={class:"dropdown-menu text-center fs-1"},We={class:"d-flex justify-content-evenly"},Qe=["onClick"],Xe=b(()=>o("div",null,"|",-1)),Ye=["onClick"],Ze=b(()=>o("div",{class:"list-group"},null,-1));function $e(l,d,I,t,w,B){var M,A,R,S,V,j,P,N,E,F;const C=y("router-link"),k=y("BookCard"),e=y("CreateCommentForm"),a=y("CommentComponent");return n(),c("div",{style:X((M=t.club)!=null&&M.isArchived?{filter:"grayscale(100%)"}:{})},[o("div",ce,[o("div",ne,[o("div",re,[o("div",ae,[o("img",{class:"clubImg image-container",src:(A=t.club)==null?void 0:A.coverImg,alt:(R=t.club)==null?void 0:R.name},null,8,le),!((S=t.club)!=null&&S.isArchived)&&((V=t.club)==null?void 0:V.creatorId)==t.account.id?(n(),c("div",ie,[o("i",{class:"mdi mdi-bookmark-remove selectable fs-1 px-2 pb-1 mx-2 glass-card rounded",onClick:d[0]||(d[0]=(...s)=>t.archiveClub&&t.archiveClub(...s))})])):v("",!0),o("div",de,[o("h4",me,g((j=t.club)==null?void 0:j.name),1),o("p",be,g((P=t.club)==null?void 0:P.bio),1)]),o("div",ue,[t.account.id?(n(),c("div",_e,[t.foundMember?(n(),c("button",{key:1,class:"btn bg-danger box-shadow",onClick:d[2]||(d[2]=s=>t.removeMember(t.foundMember.id)),disabled:(E=t.club)==null?void 0:E.isArchived},"Leave Club",8,he)):(n(),c("button",{key:0,class:"btn bg-success box-shadow",onClick:d[1]||(d[1]=s=>t.createMember()),disabled:(N=t.club)==null?void 0:N.isArchived},"Join Club",8,ve))])):v("",!0)])])]),o("div",ke,[ge,o("div",ye,[(n(!0),c(x,null,p(t.members,s=>(n(),c("div",null,[h(C,{class:"selectable",to:{name:"Profile",params:{profileId:s.profile.id}}},{default:Z(()=>[o("img",{src:s.profile.picture,alt:s.name,class:"profilePic m-1"},null,8,fe)]),_:2},1032,["to"])]))),256))])])])]),o("div",Ce,[o("div",xe,[o("div",pe,[Ie,t.activeClubBook?(n(),c("div",Re,[o("div",null,[h(k,{book:t.activeClubBook},null,8,["book"])]),o("h3",Se,g(t.activeClubBook.title),1)])):(n(),c("div",we,Ae))])]),Ve,t.foundMember&&!((F=t.club)!=null&&F.isArchived)?(n(),c("div",je,[h(e)])):v("",!0),o("div",Pe,[t.comments.length>0?(n(),c("div",{key:0,class:L(t.expanded?"expanded":"expandable")},[(n(!0),c(x,null,p(t.comments,s=>(n(),c("div",null,[h(a,{comment:s},null,8,["comment"])]))),256))],2)):(n(),c("div",Ne,Fe)),t.comments.length>2?(n(),c("div",ze,[t.expanded?(n(),c("button",{key:0,onClick:d[3]||(d[3]=(...s)=>t.expand&&t.expand(...s)),class:"btn-cool text-center"},"read less")):(n(),c("button",{key:1,onClick:d[4]||(d[4]=(...s)=>t.expand&&t.expand(...s)),class:"btn-cool text-center"},"read more"))])):v("",!0)])]),o("div",Oe,[o("div",De,[Je,o("div",null,[o("div",Le,[(n(!0),c(x,null,p(t.clubBooks,s=>{var z,O,D;return n(),c("div",null,[o("div",null,[h(k,{book:s},null,8,["book"]),o("div",qe,[o("div",null,[o("i",{onClick:J=>t.clubBookVoting(s.id),class:L(`fs-4 ${s.voteId.includes(t.account.id)?"mdi mdi-star selectable":"mdi mdi-star-outline selectable"}`),title:"vote for book"},null,10,Ge)]),o("p",He,"Votes "+g((z=s==null?void 0:s.voteId)==null?void 0:z.length),1),t.account.id==((O=t.club)==null?void 0:O.creatorId)&&!((D=t.club)!=null&&D.isArchived)?(n(),c("div",Ke,[Te,o("div",Ue,[o("div",We,[o("i",{class:"mdi mdi-book-heart-outline text-dark selectable fs-1",title:"set book active",onClick:J=>t.setBookActive(s.id)},null,8,Qe),Xe,o("i",{onClick:J=>t.removeClubBook(s.id),class:"mdi mdi-cancel text-danger selectable fs-1",title:"remove book from club"},null,8,Ye)]),Ze])])):v("",!0)])])])}),256))])])])])],4)}const to=G(se,[["render",$e],["__scopeId","data-v-9925bb29"]]);export{to as default};
